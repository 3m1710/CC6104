%\documentclass[mathserif]{beamer}
\documentclass[handout]{beamer}
%\usetheme{Goettingen}
\usetheme{Warsaw}
%\usetheme{Singapore}
%\usetheme{Frankfurt}
%\usetheme{Copenhagen}
%\usetheme{Szeged}
%\usetheme{Montpellier}
%\usetheme{CambridgeUS}
%\usecolortheme{}
%\setbeamercovered{transparent}
\usepackage[english, activeacute]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath, amssymb}
\usepackage{dsfont}
\usepackage{graphics}
\usepackage{cases}
\usepackage{graphicx}
\usepackage{pgf}
\usepackage{epsfig}
\usepackage{amssymb}
\usepackage{multirow}	
\usepackage{amstext}
\usepackage[ruled,vlined,lined]{algorithm2e}
\usepackage{amsmath}
\usepackage{epic}
\usepackage{epsfig}
\usepackage{fontenc}
\usepackage{framed,color}
\usepackage{palatino, url, multicol}
\usepackage{listings}
%\algsetup{indent=2em}
\newcommand{\factorial}{\ensuremath{\mbox{\sc Factorial}}}
\newcommand{\BIGOP}[1]{\mathop{\mathchoice%
{\raise-0.22em\hbox{\huge $#1$}}%
{\raise-0.05em\hbox{\L
\usepackage{fontenc}
\usepackage{framed,color}
\usepackage{palatino, url, multicol}
\usepackage{listings}
%\algsetup{indent=2em}
\newcommand{\factorial}{\ensuremath{\mbox{\sc Factorial}}}
\newcommand{\BIGOP}[1]{\mathop{\mathchoice%
{\raise-0.22em\hbox{\huge $#1$}}%
{\raise-0.05em\hbox{\Large $#1$}}{\hbox{\large $#1$}}{#1}}}
\newcommand{\bigtimes}{\BIGOP{\times}}
\vspace{-0.5cm}
\title{Introduction to Statistical Inference}
\vspace{-0.5cm}
\author[Felipe Bravo Márquez]{\footnotesize
%\author{\footnotesize  
 \textcolor[rgb]{0.00,0.00,1.00}{Felipe José Bravo Márquez}} 
\date{ \today }
arge $#1$}}{\hbox{\large $#1$}}{#1}}}
\newcommand{\bigtimes}{\BIGOP{\times}}
\vspace{-0.5cm}
\title{Introduction to Bayesian Inference}
\vspace{-0.5cm}
\author[Felipe Bravo Márquez]{\footnotesize
%\author{\footnotesize  
 \textcolor[rgb]{0.00,0.00,1.00}{Felipe José Bravo Márquez}} 
\date{ \today }


\begin{document}
\begin{frame}
\titlepage


\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{frame}{Some Critics to the Frequentist Approach}
\scriptsize{
\begin{itemize}
 \item The statistical methods that we have discussed so far are known as frequentist (or classical) methods.
  \item The frequentist approach requires that all probabilities be defined by connection to the frequencies of events in very large samples. 
 \item This leads to frequentist uncertainty being premised on imaginary resampling of data. 
 \item If we were to repeat the measurement many many times, we would end up collecting a list of values that will have some pattern to it. 
 \item  It means also that parameters and models cannot have probability distributions, only measurements can.
 \item The distribution of these measurements is called a sampling distribution. 
 \item This resampling is never done, and in general it doesn't even make sense.
\end{itemize}

} 
\end{frame}

\begin{frame}{Bayesian Inference}
\scriptsize{
There is another approach to inference called Bayesian inference \cite{wasserman2013all}, which is based on the following postulates:
\begin{itemize}
 \item Probability describes \textbf{degree of belief}, not limiting frequency. 
 
 \begin{itemize}
 \scriptsize{
 \item  We can make probability statements about lots of things, not just data which are subject to random variation. 
 \item For example, I might say that "the probability that Albert Einstein drank a cup of tea on August 1, 1948" is .35. 
 \item This does not refer to any limiting frequency. 
 \item It reflects my strength of belief that the proposition is true.}
 \end{itemize}
 
 \item We can make probability statements about parameters, even though they are fixed constants.
 \item We make inferences about a parameter $\theta$ by producing a probability distribution for $\theta$. Inferences, such as point estimates and interval estimates, may then be extracted from this distribution.
\end{itemize}

} 
\end{frame}


\begin{frame}{Bayesian Inference}
\scriptsize{
\begin{itemize}
 \item In modest terms, Bayesian data analysis is no more than counting the numbers of ways
the data could happen, according to our assumptions \cite{mcelreath2020statistical}.
 \item In Bayesian analysis all alternative sequences of events that could have generated our data are evaluated.
 \item As we learn about what did happen, some of these alternative sequences are pruned. 
 \item In the end, what remains is only what is logically consistent with our knowledge \cite{mcelreath2020statistical}.
 \item Warning: understanding the essence of Bayesian inference can be hard.
 \item The following toy example tries to explain it in a gentle way.
\end{itemize}
 } 
\end{frame}


\begin{frame}{Counting Possibilities}
\scriptsize{
\begin{itemize}
 \item Suppose there's a bag, and it contains four marbles.
 \item These marbles come in two colors: blue and white. 
 \item We know there are four marbles in the bag, but we don't know how many are of each color. 
 \item We do know that there are five possibilities: \includegraphics[scale=0.3]{pics/marbles1.png}
 \item These are the only possibilities consistent with what we know about the contents of the bag. Call these five possibilities the \textbf{conjectures}.
 \item Our goal is to figure out which of these conjectures is most \textbf{plausible}, given some evidence about the contents of the bag. 
 \item We do have some evidence: A sequence of three marbles is pulled from the bag, one at a time, replacing the marble each time and shaking the bag, in that order. These before drawing another marble.
 \item The sequence that emerges is: \includegraphics[scale=0.5]{pics/marbles2.png}, in that order. These are the data.
 
\end{itemize}
 } 
\end{frame}



\begin{frame}{Counting Possibilities}
\scriptsize{
\begin{itemize}
 \item Now, let's see how to use the data to infer what's in the bag.
 \item Let's begin by considering just the single conjecture, \includegraphics[scale=0.3]{pics/marbles3.png}, that the bag contains one blue and three white marbles. 
 \item On the first draw from the bag, one of four things could
happen, corresponding to one of four marbles in the bag.

\begin{figure}[h!]
	\centering
	\includegraphics[scale=0.4]{pics/marbles4.png}
\end{figure}

\item Notice that even though the three white marbles look the same from a data perspective we just record the color of the marbles, after all they are really different events.

\item This is important, because it means that there are three more ways to see \includegraphics[scale=0.3]{pics/marbles5.png} than to see \includegraphics[scale=0.3]{pics/marbles6.png}.

\end{itemize}
 } 
\end{frame}



\begin{frame}{Counting Possibilities}
\scriptsize{
\begin{itemize}
 \item Now consider the garden as we get another draw from the bag. It expands the garden out one layer:

\begin{figure}[h!]
	\centering
	\includegraphics[scale=0.4]{pics/marbles7.png}
\end{figure}

\item Now there are 16 possible paths through the garden, one for each pair of draws.

\item On the second draw from the bag, each of the paths above again forks into four possible paths. Why?

\end{itemize}
 } 
\end{frame}


\begin{frame}{Counting Possibilities}
\scriptsize{
\begin{itemize}
 \item Because we believe that our shaking of the bag gives each marble a fair chance at being drawn, regardless of which marble was drawn previously. \item The third layer is built in the same way, and the full garden is shown
 below:
\begin{figure}[h!]
	\centering
	\includegraphics[scale=0.3]{pics/marbles8.png}
\end{figure}

\item There are $4^3 = 64$ possible paths in total.

\end{itemize}
 } 
\end{frame}


\begin{frame}{Counting Possibilities}
\scriptsize{
\begin{itemize}
 \item As we consider each draw from the bag, some of these paths are logically eliminated.
 \item The first draw tuned out to be \includegraphics[scale=0.3]{pics/marbles6.png}, recall, so the three white paths at the bottom are eliminated right away. 
 \item If you imagine the real data tracing out a path, it must have passed through the one blue path near the origin. 
 \item The second draw from the bag produces \includegraphics[scale=0.3]{pics/marbles5.png}, so three of the paths forking out of the first blue marble remain.
 \end{itemize}
 } 
\end{frame}


\begin{frame}{Counting Possibilities}
\scriptsize{
\begin{itemize}
 \item As the data trace out a path, we know it must have passed through one of those three white paths (after the first blue path).
 \item But we don't know which one, because we recorded only the color of each marble.
 \item Finally, the third draw is \includegraphics[scale=0.3]{pics/marbles6.png}. 
 \item Each of the remaining three paths in the middle layer sustain one blue path, leaving a total of three ways for the sequence \includegraphics[scale=0.3]{pics/marbles2.png} to appear, assuming the bag contains \includegraphics[scale=0.3]{pics/marbles3.png}.
\end{itemize}
 } 
\end{frame}


\begin{frame}{Counting Possibilities}
\scriptsize{
\begin{itemize}
 \item The figure below shows the forking paths again, now with logically eliminated paths grayed out.

\begin{figure}[h!]
	\centering
	\includegraphics[scale=0.33]{pics/marbles9.png}
\end{figure}
\end{itemize}
 } 
\end{frame}



\begin{frame}{Counting Possibilities}
\scriptsize{
\begin{itemize}
\item We can't be sure which of those three paths the actual data took.
\item But as long as we're considering only the possibility that the bag contains one blue and three white marbles, we can be sure that the data took one of those three paths.

\item Those are the only paths consistent with both our knowledge of the bag's contents (four marbles, white or blue) and the data (\includegraphics[scale=0.3]{pics/marbles2.png}).  

 \item This demonstrates that there are three (out of 64) ways for a bag containing to produce the data.
 \item We have no way to decide among these three ways. 
\end{itemize}
 } 
\end{frame}


\begin{frame}{Counting Possibilities}
\scriptsize{
\begin{itemize}
 \item The inferential power comes from comparing this count to the numbers of ways each of the other conjectures of the bag's contents could produce the same data. 
 \item For example, consider the conjecture \includegraphics[scale=0.3]{pics/marbles10.png}. 
 \item There are zero ways for this conjecture to produce the observed data, because even one \includegraphics[scale=0.3]{pics/marbles6.png} is logically incompatible with it. 
\item The conjecture \includegraphics[scale=0.3]{pics/marbles11.png} is likewise logically incompatible with the data. 
\item So we can eliminate these two conjectures, because neither provides even a single path that is consistent with the data.
\item The next slide's figure displays all the paths for the reamaining three conjectures: \includegraphics[scale=0.3]{pics/marbles3.png}, \includegraphics[scale=0.3]{pics/marbles13.png}, and \includegraphics[scale=0.3]{pics/marbles14.png}.

\end{itemize}
 } 
\end{frame}




\begin{frame}{Counting Possibilities}
\scriptsize{
\begin{figure}[h!]
	\centering
	\includegraphics[scale=0.35]{pics/marbles12.png}
\end{figure}
 } 
\end{frame}

\begin{frame}{Counting Possibilities}
\scriptsize{
\begin{itemize}
 \item The number of ways to produce the data, for each conjecture, can be computed by first counting the number of paths in each ``ring'' of the garden and then by multiplying these counts together.
 \begin{figure}[h!]
	\centering
	\includegraphics[scale=0.3]{pics/marbles15.png}
\end{figure}
\item By comparing these counts, we have part a way to rate the relative \textbf{plausibility} of each conjectured bag composition.
\end{itemize}
 } 
\end{frame}

\begin{frame}{Combining other information}
\scriptsize{
\begin{itemize}
 \item We may have additional information about the relative plausibility of each conjecture. 
 \item This information could arise from knowledge of how the contents of the bag were generated. 
 \item It could also arise from previous data. 
 \item Whatever the source, it would help to have a way to combine different sources of information to update the plausibilities. 
 \item Luckily there is a natural solution: Just multiply the counts.
\end{itemize}
 } 
\end{frame}


\begin{frame}{Combining other information}
\scriptsize{
\begin{itemize}
 \item Suppose that each conjecture is equally plausible at the start.
 \item So we just compare the counts of ways in which each conjecture is compatible with the observed data: \includegraphics[scale=0.3]{pics/marbles2.png}.
 \item This comparison suggests that \includegraphics[scale=0.3]{pics/marbles14.png} is slightly more plausible than \includegraphics[scale=0.3]{pics/marbles13.png}, and both are about three times more plausible than \includegraphics[scale=0.3]{pics/marbles3.png}. 
\item Since these are our initial counts, and we are going to update them next, let's label them \textbf{prior}.
\item Now suppose we draw another marble from the bag to get another observation: \includegraphics[scale=0.3]{pics/marbles6.png}. 
\item How can we update our plausibilities about each conjecture based on this new evidence?
\item There are two choices discussed next. 
\end{itemize}
 } 
\end{frame}


\begin{frame}{Combining other information}
\scriptsize{
\begin{itemize}
 \item Option 1: draw a forking path with four layers and do the counting again.
\item Option 2: Update previous counts (0, 3, 8, 9, 0) with the new information by multiplying the new count by the old count.
\item Both approach are matematically identical as long
as the new observation is logically independent of the previous observations. 

\begin{figure}[h!]
	\centering
	\includegraphics[scale=0.33]{pics/marbles16.png}
\end{figure}
\end{itemize}
 } 
\end{frame}



\begin{frame}{Combining other information}
\scriptsize{
\begin{itemize}
 \item In the previous example, the prior data and new data are of the same type: marbles drawn from the bag. 
 \item But in general, the prior data and new data can be of different types. 
 \item Suppose for example that someone from the marble factory tells you that blue marbles are rare.
 \item So for every bag containing \includegraphics[scale=0.3]{pics/marbles14.png}, they made two bags containing \includegraphics[scale=0.3]{pics/marbles13.png} and three bags containing \includegraphics[scale=0.3]{pics/marbles17.png} . 
 \item They also ensured that every bag contained at least one blue and one white marble. 
\end{itemize}
 } 
\end{frame}


\begin{frame}{Combining other information}
\scriptsize{
\begin{itemize}
 \item We can update our counts again:
\begin{figure}[h!]
	\centering
	\includegraphics[scale=0.33]{pics/marbles18.png}
\end{figure}
\item Now the conjecture \includegraphics[scale=0.3]{pics/marbles13.png} is most plausible, but barely better than \includegraphics[scale=0.3]{pics/marbles14.png}.
\item Is there a threshold difference in these counts at which we can safely decide that one of the conjectures is the correct one? 
\item We will explore this question next.
\end{itemize}
 } 
\end{frame}

\begin{frame}{From counts to probability}
\scriptsize{
\begin{itemize}
 \item  So far, we have defined the updated plausibility of each possible composition of the bag, after seeing the data, as:
 \begin{figure}[h!]
	\centering
	\includegraphics[scale=0.3]{pics/marbles19.png}
\end{figure}
\item The problem of representing plausibilities as counts is that these numbers grow very quickly  as  the amount of data grows. 
 \item It is better to standardize them to turn them into probabilities.
 \item Next, we will formalize the Bayesian framework using probabilities.
\item Let index our conjecture with a parameter $\theta$ defined as the number of marbles that are blue.  $\theta=1 \rightarrow$ \includegraphics[scale=0.3]{pics/marbles14.png} 


\item We construct probabilities by standardizing the plausibility so that the sum of the plausibilities for all possible conjectures will be one.

\item This can be done using the Bayes theorem.

\begin{equation}
 \text{plausibility of $\theta$ after $d$} = \frac{\text{ways $\theta$ can produce $d$} \times \text{prior plausibility $\theta$}}{\text{sum of products}}
\end{equation}


\end{itemize}
 } 
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[allowframebreaks]\scriptsize
\frametitle{References}
\bibliography{bio}
\bibliographystyle{apalike}
%\bibliographystyle{flexbib}
\end{frame}  









%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}
